box: maven:latest

build:
  steps:
    - script:
        name: Do nothing..

build-docker-image:
  box:
    id: resttest
    username: $DOCKER_HUB_USERNAME
    password: $DOCKER_HUB_PASSWORD
  steps:
    - internal/docker-push:
        registry: $DOCKER_HUB_REGISTRY
        author: edhi
        tag: $DOCKER_HUB_TAG
        username: $DOCKER_HUB_USERNAME
        password: $DOCKER_HUB_PASSWORD
        repository: $DOCKER_HUB_REPO
        ports: $DOCKER_PORT
        user: root
        working-dir: /usr/local/
        #entrypoint: "/usr/local/tomcat/bin/catalina.sh run"

deploy:
    after-steps:
        - script:
          name: run test
          code: |
            mvn test